<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>GxE testing</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>

<!-- MathJax scripts -->
<script type="text/javascript" src="https://cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<p>*<em>Note that you can cite this work as: *</em></p>

<p><em>Jolicoeur-Martineau, A., Wazana, A., Szekely, E., Steiner, M., Fleming, A. S., Kennedy, J. L., Meaney M. J. &amp; Greenwood, C.M. (2017). Alternating optimization for GxE modelling with weighted genetic and environmental scores: examples from the MAVAN study. arXiv preprint arXiv:1703.08111.</em></p>

<p><em>Jolicoeur-Martineau, A., Belsky, J., Szekely, E., Widaman, K. F., Pluess, M., Greenwood, C., &amp; Wazana, A. (2017). Distinguishing differential susceptibility, diathesis-stress and vantage sensitivity: beyond the single gene and environment model. arXiv preprint arXiv:1712.04058.</em></p>

<h2>GxE testing</h2>

<p>From version 1.2.0 of the LEGIT package, we introduce a function to test for different types of gene-by-environment interactions (GxE) as per <a href="https://www.researchgate.net/publication/256600905_FormalGXEtestJCPP2013">Belsky et al. (2013)</a>. See our preprint: <a href="https://psyarxiv.com/27uw8">https://psyarxiv.com/27uw8</a>. We want to test if the GxE reflects diathesis stress, differential susceptibility or vantage sensitivity.</p>

<p>The figure below is a graphical representation of the different types of interactions assuming a STRONG model:</p>

<pre><code class="r">knitr::include_graphics(&quot;https://raw.githubusercontent.com/AlexiaJM/LEGIT/master/images/GxE_testing_strong.png&quot;)
</code></pre>

<p><img src="https://raw.githubusercontent.com/AlexiaJM/LEGIT/master/images/GxE_testing_strong.png" title="plot of chunk unnamed-chunk-1" alt="plot of chunk unnamed-chunk-1" width="700px" /></p>

<p>The figure below is a graphical representation of the different types of interactions assuming a WEAK model:</p>

<pre><code class="r">knitr::include_graphics(&quot;https://raw.githubusercontent.com/AlexiaJM/LEGIT/master/images/GxE_testing_weak.png&quot;)
</code></pre>

<p><img src="https://raw.githubusercontent.com/AlexiaJM/LEGIT/master/images/GxE_testing_weak.png" title="plot of chunk unnamed-chunk-2" alt="plot of chunk unnamed-chunk-2" width="700px" /></p>

<p>To test for differential susceptibility, Widaman et al. (2013) estimate the cross-over point of the model. This can be done easily with LEGIT by simply adding a negative intercept to the environment E. This can be seen by the following:
\[y = 2 + 3(E-c) + 5G(E-c) \ E = q_1e_1 + q_2e_2 + &hellip; + q_le_l\]
is equivalent to
\[y = 2 + 3E' + 5GE' \ E' = -c + q_1e_1 + q_2e_2 + &hellip; + q_le_l\]</p>

<p>To test for vantage sensitivity and diathesis-stress, we can use the model above but fix the cross-over point to the expected minimum and maximum of \(E\) respectively.</p>

<h2>Simulation of diathesis-stress, vantage sensitivity and differential susceptibility</h2>

<p>Let&#39;s look at a two-way interaction model with a cross-over point and a continuous outcome:</p>

<p>\[\mathbf{g}_j \sim Binomial(n=1,p=.30) \ j = 1, 2, 3, 4\]
\[\mathbf{e}_l  \sim 10 Beta(\alpha=2,\beta=2) \ l = 1, 2, 3\]
\[\mathbf{g} = .30\mathbf{g}_1 + .10\mathbf{g}_2 + .20\mathbf{g}_3 + .40\mathbf{g}_4 \]
\[ \mathbf{e} = .45\mathbf{e}_1 + .35\mathbf{e}_2 + .20\mathbf{e}_3\]
\[\mathbf{\mu} = 3 + \beta_E(\mathbf{e}-c) + 2\mathbf{g}(\mathbf{e}-c) \] 
where \(c\) and \(\beta_E\) depend on the model assumed. \(c = 0\) represents vantage sensitivity, \(c = 10\) represents diathesis-stress. We set \(c=5\) to represents differential susceptibility. \(\beta_E = 0\) assumes a STRONG model while \(\beta_E \ne 0\) assumes a WEAK model.</p>

<p>\[ y \sim Normal(\mu,\sigma=1)\]</p>

<p>Note that the environmental score E is in the range [0,10].</p>

<h2>Example 1: Vantage sensitivity WEAK</h2>

<p>When assuming vantage sensitivity WEAK, we let \(c=0\) so that:
\[\mathbf{\mu} = 3 + (\mathbf{e}-0) + 2\mathbf{g}(\mathbf{e}-0) \] </p>

<p>We generate N=250 observations and test all 4 possible models based on the BIC (other choices are also available: AIC, AICc, cross-validation and cross-validated AUC). It is important to not include G or E in the model formula because they will be added automatically. We start by assuming that we don&#39;t know the true minimum of the environmental score, thus we use option <em>crossover = c(&ldquo;min&rdquo;,&ldquo;max&rdquo;)</em> to find the minimum/maximum from the observed data (this is the default). </p>

<pre><code class="r">set.seed(777)
library(LEGIT)
</code></pre>

<pre><code>## Loading required package: formula.tools
</code></pre>

<pre><code class="r">ex_dia = example_with_crossover(N=250, c=0, coef_main = c(3,1,2), sigma=1, seed=7)
GxE_test_BIC = GxE_interaction_test(data=ex_dia$data, genes=ex_dia$G, env=ex_dia$E, formula_noGxE = y ~ 1, crossover = c(&quot;min&quot;,&quot;max&quot;), criterion=&quot;BIC&quot;)
GxE_test_BIC$results
</code></pre>

<pre><code>##                                    BIC       crossover crossover 95%      
## Vantage sensitivity WEAK           &quot;772.27&quot;  &quot;0.45&quot;    &quot;&quot;                 
## Differential susceptibility WEAK   &quot;775.08&quot;  &quot;-0.4&quot;    &quot;( -0.73 / -0.07 )&quot;
## Differential susceptibility STRONG &quot;870.68&quot;  &quot;2.22&quot;    &quot;( 1.79 / 2.64 )&quot;  
## Vantage sensitivity STRONG         &quot;930.4&quot;   &quot;0.44&quot;    &quot;&quot;                 
## Diathesis-stress WEAK              &quot;971.12&quot;  &quot;9.75&quot;    &quot;&quot;                 
## Diathesis-stress STRONG            &quot;1123.61&quot; &quot;9.74&quot;    &quot;&quot;                 
## G + E only                         &quot;1237.56&quot; NA        &quot;&quot;                 
## G only                             &quot;1285.07&quot; NA        &quot;&quot;                 
## E only                             &quot;1308.15&quot; NA        &quot;&quot;                 
## Intercept only                     &quot;1341.59&quot; NA        &quot;&quot;                 
##                                    Within observable range?
## Vantage sensitivity WEAK           &quot;&quot;                      
## Differential susceptibility WEAK   &quot;No&quot;                    
## Differential susceptibility STRONG &quot;No&quot;                    
## Vantage sensitivity STRONG         &quot;&quot;                      
## Diathesis-stress WEAK              &quot;&quot;                      
## Diathesis-stress STRONG            &quot;&quot;                      
## G + E only                         &quot;&quot;                      
## G only                             &quot;&quot;                      
## E only                             &quot;&quot;                      
## Intercept only                     &quot;&quot;                      
##                                    % of observations below crossover
## Vantage sensitivity WEAK           &quot;0&quot;                              
## Differential susceptibility WEAK   &quot;0&quot;                              
## Differential susceptibility STRONG &quot;0.004&quot;                          
## Vantage sensitivity STRONG         &quot;0&quot;                              
## Diathesis-stress WEAK              &quot;1&quot;                              
## Diathesis-stress STRONG            &quot;1&quot;                              
## G + E only                         NA                               
## G only                             NA                               
## E only                             NA                               
## Intercept only                     NA
</code></pre>

<p>Here we see the results. Notice that vantage sensitivity WEAK is the model with the lowest BIC. Differential susceptibility WEAK has a slightly worse fit and the crossover point is not within observable range, thus we reject it. Note that we only show the element <em>results</em> of the output, but the 6 models (weak/strong vantage sensitivity, diathesis-stress and differential susceptibility) are also returned.</p>

<p>Considering that we know that the minimum and maximum of E are 0 and 10 respectively, we can also refit the models with <em>crossover = c(0, 10)</em>.</p>

<pre><code class="r">GxE_test_BIC_ = GxE_interaction_test(data=ex_dia$data, genes=ex_dia$G, env=ex_dia$E, formula_noGxE = y ~ 1, crossover = c(0, 10), criterion=&quot;BIC&quot;)
GxE_test_BIC_$results
</code></pre>

<pre><code>##                                    BIC       crossover crossover 95%      
## Vantage sensitivity WEAK           &quot;770.07&quot;  &quot;0&quot;       &quot;&quot;                 
## Differential susceptibility WEAK   &quot;775.08&quot;  &quot;-0.4&quot;    &quot;( -0.73 / -0.07 )&quot;
## Differential susceptibility STRONG &quot;870.68&quot;  &quot;2.22&quot;    &quot;( 1.79 / 2.64 )&quot;  
## Vantage sensitivity STRONG         &quot;948.33&quot;  &quot;0&quot;       &quot;&quot;                 
## Diathesis-stress WEAK              &quot;965.08&quot;  &quot;10&quot;      &quot;&quot;                 
## Diathesis-stress STRONG            &quot;1125.2&quot;  &quot;10&quot;      &quot;&quot;                 
## G + E only                         &quot;1237.56&quot; NA        &quot;&quot;                 
## G only                             &quot;1285.07&quot; NA        &quot;&quot;                 
## E only                             &quot;1308.15&quot; NA        &quot;&quot;                 
## Intercept only                     &quot;1341.59&quot; NA        &quot;&quot;                 
##                                    Within observable range?
## Vantage sensitivity WEAK           &quot;&quot;                      
## Differential susceptibility WEAK   &quot;No&quot;                    
## Differential susceptibility STRONG &quot;No&quot;                    
## Vantage sensitivity STRONG         &quot;&quot;                      
## Diathesis-stress WEAK              &quot;&quot;                      
## Diathesis-stress STRONG            &quot;&quot;                      
## G + E only                         &quot;&quot;                      
## G only                             &quot;&quot;                      
## E only                             &quot;&quot;                      
## Intercept only                     &quot;&quot;                      
##                                    % of observations below crossover
## Vantage sensitivity WEAK           &quot;0&quot;                              
## Differential susceptibility WEAK   &quot;0&quot;                              
## Differential susceptibility STRONG &quot;0.004&quot;                          
## Vantage sensitivity STRONG         &quot;0&quot;                              
## Diathesis-stress WEAK              &quot;1&quot;                              
## Diathesis-stress STRONG            &quot;1&quot;                              
## G + E only                         NA                               
## G only                             NA                               
## E only                             NA                               
## Intercept only                     NA
</code></pre>

<p>We obtain similar results.</p>

<p>We can then plot the best model:</p>

<pre><code class="r">plot(GxE_test_BIC$fits$vantage_sensitivity_WEAK, xlim=c(0,10), ylim=c(3,13),cex.leg=1.4, cex.axis=1.5, cex.lab=1.5)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk fig1"/></p>

<h2>Example 2: Vantage sensitivity STRONG</h2>

<p>When assuming vantage sensitivity STRONG, we let \(c=0\) and \(\beta_E=0\) so that:
\[\mathbf{\mu} = 3 + 2\mathbf{g}(\mathbf{e}-0) \] </p>

<p>We generate N=250 observations and test all 6 possible models based on the BIC assuming we don&#39;t know what is the minimum environmental score.</p>

<pre><code class="r">ex_dia_s = example_with_crossover(N=250, c=0, coef_main = c(3,0,2), sigma=1, seed=7)
GxE_test_BIC = GxE_interaction_test(data=ex_dia_s$data, genes=ex_dia_s$G, env=ex_dia_s$E, formula_noGxE = y ~ 1, crossover = c(&quot;min&quot;,&quot;max&quot;), criterion=&quot;BIC&quot;)
GxE_test_BIC$results
</code></pre>

<pre><code>##                                    BIC       crossover crossover 95%     
## Differential susceptibility STRONG &quot;770.17&quot;  &quot;-0.5&quot;    &quot;( -1.22 / 0.23 )&quot;
## Vantage sensitivity STRONG         &quot;771.77&quot;  &quot;0.45&quot;    &quot;&quot;                
## Vantage sensitivity WEAK           &quot;772.93&quot;  &quot;0.45&quot;    &quot;&quot;                
## Differential susceptibility WEAK   &quot;775.68&quot;  &quot;-0.45&quot;   &quot;( -1.18 / 0.27 )&quot;
## Diathesis-stress WEAK              &quot;967.38&quot;  &quot;9.74&quot;    &quot;&quot;                
## Diathesis-stress STRONG            &quot;1104.84&quot; &quot;9.75&quot;    &quot;&quot;                
## G + E only                         &quot;1170.07&quot; NA        &quot;&quot;                
## G only                             &quot;1171.24&quot; NA        &quot;&quot;                
## Intercept only                     &quot;1247.53&quot; NA        &quot;&quot;                
## E only                             &quot;1248.73&quot; NA        &quot;&quot;                
##                                    Within observable range?
## Differential susceptibility STRONG &quot;No&quot;                    
## Vantage sensitivity STRONG         &quot;&quot;                      
## Vantage sensitivity WEAK           &quot;&quot;                      
## Differential susceptibility WEAK   &quot;No&quot;                    
## Diathesis-stress WEAK              &quot;&quot;                      
## Diathesis-stress STRONG            &quot;&quot;                      
## G + E only                         &quot;&quot;                      
## G only                             &quot;&quot;                      
## Intercept only                     &quot;&quot;                      
## E only                             &quot;&quot;                      
##                                    % of observations below crossover
## Differential susceptibility STRONG &quot;0&quot;                              
## Vantage sensitivity STRONG         &quot;0&quot;                              
## Vantage sensitivity WEAK           &quot;0&quot;                              
## Differential susceptibility WEAK   &quot;0&quot;                              
## Diathesis-stress WEAK              &quot;1&quot;                              
## Diathesis-stress STRONG            &quot;1&quot;                              
## G + E only                         NA                               
## G only                             NA                               
## Intercept only                     NA                               
## E only                             NA
</code></pre>

<p>We conclude that vantage sensitivity STRONG is the best model.</p>

<p>We can then plot the best model:</p>

<pre><code class="r">plot(GxE_test_BIC$fits$vantage_sensitivity_STRONG, xlim=c(0,10), ylim=c(3,13),cex.leg=1.4, cex.axis=1.5, cex.lab=1.5)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk fig2"/></p>

<h2>Example 3: Differential susceptibility WEAK</h2>

<p>When assuming differential susceptibility WEAK, we let \(c=5\) (and use 8 instead of 3 as intercept to keep a similar outcome range) so that:
\[\mathbf{\mu} = 8 + (\mathbf{e}-5) + 2\mathbf{g}(\mathbf{e}-5) \] </p>

<p>We generate N=250 observations and test all 6 possible models based on the BIC assuming we don&#39;t know what is the minimum environmental score.</p>

<pre><code class="r">ex_ds = example_with_crossover(N=250, c=5, coef_main = c(3+5,1,2), sigma=1, seed=7)
GxE_test_BIC = GxE_interaction_test(data=ex_ds$data, genes=ex_ds$G, env=ex_ds$E, formula_noGxE = y ~ 1, crossover = c(&quot;min&quot;,&quot;max&quot;), criterion=&quot;BIC&quot;)
GxE_test_BIC$results
</code></pre>

<pre><code>##                                    BIC       crossover crossover 95%   
## Differential susceptibility WEAK   &quot;776.06&quot;  &quot;4.83&quot;    &quot;( 4.5 / 5.16 )&quot;
## Diathesis-stress WEAK              &quot;834.53&quot;  &quot;9.74&quot;    &quot;&quot;              
## Vantage sensitivity WEAK           &quot;835.05&quot;  &quot;0.45&quot;    &quot;&quot;              
## Differential susceptibility STRONG &quot;864.07&quot;  &quot;4.78&quot;    &quot;( 4.37 / 5.2 )&quot;
## E only                             &quot;1011.14&quot; NA        &quot;&quot;              
## G + E only                         &quot;1011.79&quot; NA        &quot;&quot;              
## Intercept only                     &quot;1149.96&quot; NA        &quot;&quot;              
## G only                             &quot;1153.2&quot;  NA        &quot;&quot;              
## Diathesis-stress STRONG            &quot;1157.61&quot; &quot;6.95&quot;    &quot;&quot;              
## Vantage sensitivity STRONG         &quot;1159.69&quot; &quot;-2.28&quot;   &quot;&quot;              
##                                    Within observable range?
## Differential susceptibility WEAK   &quot;Yes&quot;                   
## Diathesis-stress WEAK              &quot;&quot;                      
## Vantage sensitivity WEAK           &quot;&quot;                      
## Differential susceptibility STRONG &quot;Yes&quot;                   
## E only                             &quot;&quot;                      
## G + E only                         &quot;&quot;                      
## Intercept only                     &quot;&quot;                      
## G only                             &quot;&quot;                      
## Diathesis-stress STRONG            &quot;&quot;                      
## Vantage sensitivity STRONG         &quot;&quot;                      
##                                    % of observations below crossover
## Differential susceptibility WEAK   &quot;0.488&quot;                          
## Diathesis-stress WEAK              &quot;1&quot;                              
## Vantage sensitivity WEAK           &quot;0&quot;                              
## Differential susceptibility STRONG &quot;0.476&quot;                          
## E only                             NA                               
## G + E only                         NA                               
## Intercept only                     NA                               
## G only                             NA                               
## Diathesis-stress STRONG            &quot;1&quot;                              
## Vantage sensitivity STRONG         &quot;0.044&quot;
</code></pre>

<p>We conclude that differential susceptibility WEAK is the best model.</p>

<p>We can then plot the best model:</p>

<pre><code class="r">plot(GxE_test_BIC$fits$diff_suscept_WEAK, xlim=c(0,10), ylim=c(3,13),cex.leg=1.4, cex.axis=1.5, cex.lab=1.5)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk fig3"/></p>

<h2>Example 4: Differential susceptibility STRONG</h2>

<p>When assuming differential susceptibility STRONG, we let \(c=5\) and \(\beta_E=0\) (and use 8 instead of 3 as intercept to keep a similar outcome range) so that:
\[\mathbf{\mu} = 8 + 2\mathbf{g}(\mathbf{e}-5) \] </p>

<p>We generate N=250 observations and test all 6 possible models based on the BIC assuming we don&#39;t know what is the minimum environmental score.</p>

<pre><code class="r">ex_ds_s = example_with_crossover(N=250, c=5, coef_main = c(3+5,0,2), sigma=1, seed=7)
GxE_test_BIC = GxE_interaction_test(data=ex_ds_s$data, genes=ex_ds_s$G, env=ex_ds_s$E, formula_noGxE = y ~ 1, crossover = c(&quot;min&quot;,&quot;max&quot;), criterion=&quot;BIC&quot;)
GxE_test_BIC$results
</code></pre>

<pre><code>##                                    BIC      crossover crossover 95%    
## Differential susceptibility STRONG &quot;771.2&quot;  &quot;4.84&quot;    &quot;( 4.13 / 5.55 )&quot;
## Differential susceptibility WEAK   &quot;776.64&quot; &quot;4.84&quot;    &quot;( 4.12 / 5.55 )&quot;
## Diathesis-stress WEAK              &quot;834.4&quot;  &quot;9.74&quot;    &quot;&quot;               
## Vantage sensitivity WEAK           &quot;834.9&quot;  &quot;0.44&quot;    &quot;&quot;               
## E only                             &quot;848.02&quot; NA        &quot;&quot;               
## G + E only                         &quot;851.11&quot; NA        &quot;&quot;               
## Intercept only                     &quot;895.99&quot; NA        &quot;&quot;               
## G only                             &quot;899.81&quot; NA        &quot;&quot;               
## Diathesis-stress STRONG            &quot;909.24&quot; &quot;6.77&quot;    &quot;&quot;               
## Vantage sensitivity STRONG         &quot;913.1&quot;  &quot;-2.45&quot;   &quot;&quot;               
##                                    Within observable range?
## Differential susceptibility STRONG &quot;Yes&quot;                   
## Differential susceptibility WEAK   &quot;Yes&quot;                   
## Diathesis-stress WEAK              &quot;&quot;                      
## Vantage sensitivity WEAK           &quot;&quot;                      
## E only                             &quot;&quot;                      
## G + E only                         &quot;&quot;                      
## Intercept only                     &quot;&quot;                      
## G only                             &quot;&quot;                      
## Diathesis-stress STRONG            &quot;&quot;                      
## Vantage sensitivity STRONG         &quot;&quot;                      
##                                    % of observations below crossover
## Differential susceptibility STRONG &quot;0.484&quot;                          
## Differential susceptibility WEAK   &quot;0.484&quot;                          
## Diathesis-stress WEAK              &quot;1&quot;                              
## Vantage sensitivity WEAK           &quot;0&quot;                              
## E only                             NA                               
## G + E only                         NA                               
## Intercept only                     NA                               
## G only                             NA                               
## Diathesis-stress STRONG            &quot;1&quot;                              
## Vantage sensitivity STRONG         &quot;0.036&quot;
</code></pre>

<p>We conclude that differential susceptibility STRONG is the best model.</p>

<p>We can then plot the best model:</p>

<pre><code class="r">plot(GxE_test_BIC$fits$diff_suscept_STRONG, xlim=c(0,10), ylim=c(3,13),cex.leg=1.4, cex.axis=1.5, cex.lab=1.5)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk fig4"/></p>

</body>

</html>
